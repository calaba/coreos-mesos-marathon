[Unit]
Description=Announce Zookeeper 2 service
BindsTo=zookeeper.2.service

[Service]
ExecStart=/bin/sh -c ". /etc/environment; while true; do etcdctl set /services/zookeeper/zookeeper2 \"{ \"host\": \"%H\", \"IP\": \"$COREOS_PRIVATE_IPV4\", \"ports\": [ 2181, 2888, 3888] }\" --ttl 60;sleep 45;done"
ExecStop=/usr/bin/etcdctl rm /services/zookeeper/zookeeper2

[X-Fleet]
X-ConditionMachineOf=zookeeper.2.service
