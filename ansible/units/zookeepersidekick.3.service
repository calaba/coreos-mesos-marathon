[Unit]
Description=Announce Zookeeper 3 service
BindsTo=zookeeper.3.service

[Service]
ExecStart=/bin/sh -c ". /etc/environment; while true; do etcdctl set /services/zookeeper/zookeeper3 \"{ \"host\": \"%H\", \"IP\": \"$COREOS_PRIVATE_IPV4\", \"ports\": [ 2181, 2888, 3888] }\" --ttl 60;sleep 45;done"
ExecStop=/usr/bin/etcdctl rm /services/zookeeper/zookeeper3

[X-Fleet]
X-ConditionMachineOf=zookeeper.3.service
